From b52b0bc1432619fc6b0424ca4f16b0077a42362f Mon Sep 17 00:00:00 2001
From: Will Dietz <w@wdtz.org>
Date: Thu, 24 Oct 2019 13:10:44 -0500
Subject: [PATCH] Don't pass NULL as src to memcpy, even when zero len.

Skip the memcpy when len = 0, definitely don't ignore attempt
to copy X bytes from NULL where X != 0 :).
---
 monitor/main.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/monitor/main.c b/monitor/main.c
index 8b48cf8..663ef3e 100644
--- a/monitor/main.c
+++ b/monitor/main.c
@@ -176,7 +176,8 @@ static size_t rta_add(void *rta_buf, unsigned short type, uint16_t len,
 
 	rta->rta_len = rta_len;
 	rta->rta_type = type;
-	memcpy(RTA_DATA(rta), data, len);
+  if (len)
+    memcpy(RTA_DATA(rta), data, len);
 
 	return RTA_SPACE(len);
 }
-- 
2.24.0-rc1

